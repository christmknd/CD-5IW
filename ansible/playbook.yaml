--- 
- hosts: azure_vm
  tasks:

    - name: Update 
      apt: 
        update_cache: true 
        cache_valid_time: 3000
        force_apt_get: true 

    - name: Install dependancies
      become: true
      ansible.builtin.apt: 
        pkg:
          - npm
          - nodejs
        state: latest
        update_cache: true

    - name: Git Clone Repo 
      become: true
      ansible.builtin.git:
        repo: https://github.com/christmknd/CD-5IW.git
        dest: /home/azureuser/project
        clone: true
        update: true

    - name: Install Dependancies on project 

      become: true
      npm: 
        path: /home/azureuser/project

    - name: Build App
      become: true
      shell: npm run build 

    - name: Start App
      become: true
      shell: npm start /home/azureuser/project/main.ts



    

